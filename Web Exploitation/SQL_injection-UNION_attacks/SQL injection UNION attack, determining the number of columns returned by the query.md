# UNION ATTACKS

## SQL injection UNION attack, determining the number of columns returned by the query

### Description
 This lab contains a SQL injection vulnerability in the product category filter. The results from the query are returned in the application's response, so you can use a UNION attack to retrieve data from other tables. The first step of such an attack is to determine the number of columns that are being returned by the query. You will then use this technique in subsequent labs to construct the full attack.

To solve the lab, determine the number of columns returned by the query by performing a SQL injection UNION attack that returns an additional row containing null values. 

### Solve

- Using the burp suite, I intercepted the outgoing request:

   request

- After sending the request to the repeater, I started using the UNION attacks to find out the number of columns beginning with `category=Corporate+gifts'UNION+SELECT+NULL-- `. This one gave an error so increased the number of 'NULL' present in the query by one. Again got an error. Finally when the number of NULLs was made three, the lab was solved.

   solve

   solve 1

### Learnings
1. One of the methods to find the number of columns in a table involves submitting a series of UNION SELECT payloads specifying a different number of null values:

```
' UNION SELECT NULL--
' UNION SELECT NULL,NULL--
' UNION SELECT NULL,NULL,NULL--
etc.
```

2. If the number of nulls does not match the number of columns, the database returns an error.
3. We use NULL as the values returned from the injected SELECT query because the data types in each column must be compatible between the original and the injected queries. NULL is convertible to every common data type, so it maximizes the chance that the payload will succeed when the column count is correct. 
4. Another method involves injecting a series of ORDER BY clauses and incrementing the specified column index until an error occurs:

```
' ORDER BY 1--
' ORDER BY 2--
' ORDER BY 3--
etc.
```

5. When the specified column index exceeds the number of actual columns in the result set, the database returns an error.